{% extends "base.html" %}
{% block title %}Calcular Meta â€” Sistema de Metas{% endblock %}
{% block page_title %}Calcular Meta Ajustada{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="card shadow-sm p-4">
    <h5 class="mb-4"><i class="bi bi-calculator-fill text-success"></i> Calcular Meta Ajustada</h5>

    <form id="calcForm" class="row g-4">
      <div class="col-md-3">
        <label class="form-label fw-semibold">Modelo</label>
        <select class="form-select form-select-lg" name="codigo" required>
          {% for c in codigos %}
            <option>{{ c }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="col-md-3">
        <label class="form-label fw-semibold">Pessoas atuais</label>
        <input class="form-control form-control-lg" name="pessoas_atuais" type="number" required>
      </div>

      <div class="col-md-3">
        <label class="form-label fw-semibold">Minutos</label>
        <input class="form-control form-control-lg" name="minutos" type="number" value="60" required>
      </div>

      <div class="col-md-3 d-flex align-items-end">
        <button class="btn btn-success btn-lg w-100" type="submit">
          <i class="bi bi-play-circle"></i> Calcular
        </button>
      </div>
    </form>

    <div id="resultadoCalc" class="mt-4 p-3 border rounded shadow-sm bg-light text-center fw-semibold"></div>
  </div>
</div>

<script>
document.getElementById('calcForm').addEventListener('submit', async e => {
  e.preventDefault();
  const fd = new FormData(e.target);
  const resp = await fetch('/calcular_meta', {method:'POST', body: fd});
  const data = await resp.json();
  document.getElementById('resultadoCalc').innerHTML = data.resultado;
});
</script>
{% endblock %}
